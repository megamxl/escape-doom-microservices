import { Client } from "@stomp/stompjs";

export const initializeStompClient = async () => {
    try {
        const token = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhMWpvYmVzSFdwV0lEQUpnRUpLVEQwYWxBQUt1c0k0eWhiTjZWdnlnQzBBIn0.eyJleHAiOjE3NDA3ODQzNzQsImlhdCI6MTc0MDc4NDA3NCwiYXV0aF90aW1lIjoxNzQwNzgzMTY0LCJqdGkiOiI2YzllY2ZhZi1lYWYwLTRlYzItYTE5Zi1kNGQ2Yzc4NDk1MGMiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjkwODEvcmVhbG1zL2VzY2FwZS1kb29tIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImMzMjE4NmExLWFkODMtNGQ2NC1hMDlkLWFiMDFiMDBjMzQ2MiIsInR5cCI6IkJlYXJlciIsImF6cCI6ImdhdGV3YXkiLCJzaWQiOiIzODY3ZTZkMy1mMTliLTRkNDQtODU4Ni1lZGI1NGEwNmNjN2UiLCJhY3IiOiIwIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtZXNjYXBlLWRvb20iLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiZ2F0ZXdheSI6eyJyb2xlcyI6WyJMRUNUT1IiXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJBbmFzIEthbWJhbCIsInByZWZlcnJlZF91c2VybmFtZSI6ImFuYXNrYXkiLCJnaXZlbl9uYW1lIjoiQW5hcyIsImZhbWlseV9uYW1lIjoiS2FtYmFsIiwiZW1haWwiOiJhbmFzLmthbWJhbEBzdHVkLmZoLWNhbXB1c3dpZW4uYWMuYXQifQ.cOKqpszqVjkOr0axETRQp5YhBZBgKTRuGZ8r9KMKu2VuLGcw-DVNnLmwgnZ1TSsLH-nFZoIMd49Qi_NtUDOIEt8g-x6looSBSjxIfm6RqaTu8cnqhbz3zMIcIp-RXgtO2-RqEUhEjh9LdQEDJZkTERrZIkJBoo16JNrUxorFMNFlcNSrgExgKa7_aBuqyoAFZCNiZSn-u--r1iRJ0jPsci86h1g5fJ5tWfogq0Qytv_Tnn7wFST52VC7Wz6FeXILHB4OhXvy4u3EeyfKFPVYuCc_5dqhrkImQ338pM_nfZ-Mp-FYRwbn1HPV9yyPBVO6MlbXmJdzpz3WLK7ZrHRkTw.eyJleHAiOjE3NDA3ODQwNzUsImlhdCI6MTc0MDc4Mzc3NSwiYXV0aF90aW1lIjoxNzQwNzgzMTY0LCJqdGkiOiI1NWE3YjViZS1mMGZkLTRhNTktODJkYy0zMDAxODE4M2I5NDQiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjkwODEvcmVhbG1zL2VzY2FwZS1kb29tIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImMzMjE4NmExLWFkODMtNGQ2NC1hMDlkLWFiMDFiMDBjMzQ2MiIsInR5cCI6IkJlYXJlciIsImF6cCI6ImdhdGV3YXkiLCJzaWQiOiIzODY3ZTZkMy1mMTliLTRkNDQtODU4Ni1lZGI1NGEwNmNjN2UiLCJhY3IiOiIwIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtZXNjYXBlLWRvb20iLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiZ2F0ZXdheSI6eyJyb2xlcyI6WyJMRUNUT1IiXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJBbmFzIEthbWJhbCIsInByZWZlcnJlZF91c2VybmFtZSI6ImFuYXNrYXkiLCJnaXZlbl9uYW1lIjoiQW5hcyIsImZhbWlseV9uYW1lIjoiS2FtYmFsIiwiZW1haWwiOiJhbmFzLmthbWJhbEBzdHVkLmZoLWNhbXB1c3dpZW4uYWMuYXQifQ.I4R_n2eVtQmiUYNLzfQ-sUMIOBse_M5upWV89iuunDwhXNS031YysH-fhdlb2fNmare1rU6ZF93mWK7eeXRlGYpE36GhERO4MS2fhCttReaQodhaupWpBT0TeDjXBl7ivyO5VzGymtv38qxSMKMA6T9vnK6IHGV9QY1t1FC96_lVZ7eS3ISjb03uNWN6fhBRzykXNTUOoowGKWZ7PRw1DRSk1_VolUGjhwURL7ZL_DZOl9hE1UOKm1YOyf1orEh-shAWGKULL2io08pMN0zY7GKtdRlUhDPoaPqtCC_DAJUlmI2KdGoykAtElHoVyXTBZZ3Mn6_38fZI2fKiIlxaOg.eyJleHAiOjE3NDA3ODQwNzUsImlhdCI6MTc0MDc4Mzc3NSwiYXV0aF90aW1lIjoxNzQwNzgzMTY0LCJqdGkiOiI1NWE3YjViZS1mMGZkLTRhNTktODJkYy0zMDAxODE4M2I5NDQiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjkwODEvcmVhbG1zL2VzY2FwZS1kb29tIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImMzMjE4NmExLWFkODMtNGQ2NC1hMDlkLWFiMDFiMDBjMzQ2MiIsInR5cCI6IkJlYXJlciIsImF6cCI6ImdhdGV3YXkiLCJzaWQiOiIzODY3ZTZkMy1mMTliLTRkNDQtODU4Ni1lZGI1NGEwNmNjN2UiLCJhY3IiOiIwIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtZXNjYXBlLWRvb20iLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiZ2F0ZXdheSI6eyJyb2xlcyI6WyJMRUNUT1IiXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJBbmFzIEthbWJhbCIsInByZWZlcnJlZF91c2VybmFtZSI6ImFuYXNrYXkiLCJnaXZlbl9uYW1lIjoiQW5hcyIsImZhbWlseV9uYW1lIjoiS2FtYmFsIiwiZW1haWwiOiJhbmFzLmthbWJhbEBzdHVkLmZoLWNhbXB1c3dpZW4uYWMuYXQifQ.I4R_n2eVtQmiUYNLzfQ-sUMIOBse_M5upWV89iuunDwhXNS031YysH-fhdlb2fNmare1rU6ZF93mWK7eeXRlGYpE36GhERO4MS2fhCttReaQodhaupWpBT0TeDjXBl7ivyO5VzGymtv38qxSMKMA6T9vnK6IHGV9QY1t1FC96_lVZ7eS3ISjb03uNWN6fhBRzykXNTUOoowGKWZ7PRw1DRSk1_VolUGjhwURL7ZL_DZOl9hE1UOKm1YOyf1orEh-shAWGKULL2io08pMN0zY7GKtdRlUhDPoaPqtCC_DAJUlmI2KdGoykAtElHoVyXTBZZ3Mn6_38fZI2fKiIlxaOg";
        if (!token) throw new Error("Failed to get Keycloak token");

        const client = new Client({
            brokerURL: "ws://localhost:8081/player-api/gs-guide-websocket",
            connectHeaders: {
                Authorization: `Bearer ${token}`,
            },
            reconnectDelay: 5000, // Auto-reconnect after 5 sec
        });

        return client;
    } catch (error) {
        console.error("Error initializing STOMP client:", error);
        return null;
    }
};
